{%- capture article_class %}js-comment comment{% if include.name == site.author.name %} admin{% endif %}{% if
include.is_reply %} child{% endif %}{% endcapture %}
{% assign comment_id = include.uid | prepend: 'comment-' %}
<article id="{{ comment_id }}" class="{{ article_class }}" uid="{{ include.uid }}">
    <div class="d-flex flex-row">
        <div>
            <img class="comment__avatar rounded me-3 m-0"
                src="https://www.gravatar.com/avatar/{{ include.email }}?d=identicon&s=64" alt="{{ include.name }}">
        </div>

        <div class="flex-column">
            <div class="comment__author fw-bold text-black">
                {% if include.name == site.author.name %}
                <span class="comment__admin_tag">Author</span>
                {% endif %}
                {{- include.name | strip_html }}
            </div>

            <small class="comment__date fw-normal">
                {%- if include.date -%}
                {{ include.date | date:"%b %d, %Y" }} &bull; <a href="#{{ comment_id }}"
                    title="Permalink to this comment">Permalink</a>
                {%- endif -%}
            </small>
        </div>
    </div>

    <div class="comment__body pt-3">
        {{ include.message | strip_html | markdownify }}
    </div>

    {% if include.is_reply %}
</article>
{% else %}
<div class="comment__meta">
    <a rel="nofollow" class="comment__reply-link"
        onclick="return addComment.moveForm('{{ comment_id }}', '{{ include.uid }}', 'respond', '{{ page.slug }}', '{{ include.name }}');">&#8618;
        Reply to {{ include.name }}
    </a>
</div>
</article>

{%- capture this_uid %}{{ include.uid }}{% endcapture %}
{%- assign replies = site.data.comments[page.slug] | where_exp: 'item', 'item.replying_to_uid == this_uid' %}
{%- assign replies_date = replies | sort: 'date' %}
{% for reply in replies_date %}
{%- assign email = reply.email -%}
{%- assign name = reply.name -%}
{%- assign date = reply.date -%}
{%- assign message = reply.message -%}
{%- assign uid = reply._id -%}
{% include comment.html is_reply=true uid=uid email=email name=name date=date message=message %}
{% endfor %}

<hr class="comment__break" />
{% endif %}