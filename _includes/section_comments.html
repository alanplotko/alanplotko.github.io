{% if site.api.staticman and site.api.staticman.endpoint %}

<div class="staticman-comments">
    <div class="page__comments">
        <!-- Start static comments -->
        <div class="js-comments">
            {% if site.data.comments[page.slug] %}
            <h1 class="page__comments-title pb-2">Comments</h1>
            {% assign comments = site.data.comments[page.slug] | where_exp: "comment", "comment.replying_to_uid == ''" %}
            {% assign comments_by_date = comments | sort: 'date' | reverse %}
            <!-- List main comments in reverse date order, newest first. List replies in date order, oldest first. -->
            {% for comment in comments_by_date %}
                {%- assign email = comment.email -%}
                {%- assign name = comment.name -%}
                {%- assign date = comment.date -%}
                {%- assign message = comment.message -%}
                {%- assign uid = comment._id -%}
                {% include comment.html is_reply=false uid=uid replying_to=0 email=email name=name date=date message=message uid=uid %}
            {% endfor %}
            {% endif %}
        </div>
        <!-- End static comments -->
    </div>
</div>

<div class="pt-3"></div>

{% unless page.comments_locked == true %}
<!-- New comment form -->
<div id="respond" class="comment__new">
    {% include comment_form.html %}
</div>
<!-- End new comment form -->
{% else %}
<p class="lead"><em>Comments are closed for this post.</em></p>
{% endunless %}
{% endif %}